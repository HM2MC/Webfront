{% extends "base_page.html" %}
{% load search_extras %}

{%block title%} M2M - Results: Page {{page}}{%endblock%}

{%block scriptin%}
<script type="text/javascript">
$


</script>
{%endblock%}

{% block extraContent %}

    {%if  filesfound %}
    <div class="tablewrap">
        <table>
            {# Table Headings #}
            <thead>
            <tr class="info">
                <td width="2.5%"> </td>
                <td width="72%" align="left">
                    <a href="{% url search.views.results %}?q={{q}}&{% if optionsUp == '1'%}optionsUp=1&{%endif%}order={%if params.order == 'Name'%}-Name{%else%}Name{%endif%}&mode={{mode}}&type={{params.type}}">
                        File Name
                        {%if params.order == 'Name'%}<img src="/media/images/asc.gif"/>
                        {%else%}{%if params.order == '-Name'%}<img src="/media/images/desc.gif"/>{%endif%}{%endif%}
                    </a>
                </td>
                <td width="9%">
                    <a href="{% url search.views.results %}?q={{q}}&{% if optionsUp == '1'%}optionsUp=1&{%endif%}order={%if params.order == '-FileSize'%}FileSize{%else%}-FileSize{%endif%}&mode={{mode}}&type={{params.type}}">
                        Size
                        {%if params.order == 'FileSize'%}<img src="/media/images/desc.gif"/>
                        {%else%}{%if params.order == '-FileSize'%}<img src="/media/images/asc.gif"/>{%endif%}{%endif%}
                    </a>
                </td>
                
                <td width="7%" align="center">
                    <a href="{% url search.views.results %}?q={{q}}&{% if optionsUp == '1'%}optionsUp=1&{%endif%}order={%if params.order == '-DateAdded'%}DateAdded{%else%}-DateAdded{%endif%}&mode={{mode}}&type={{params.type}}">
                        Date
                        {%if params.order == '-DateAdded'%}<img src="/media/images/asc.gif"/>
                        {%else%}{%if params.order == 'DateAdded'%}<img src="/media/images/desc.gif"/>{%endif%}{%endif%}
                    </a>
                </td>
                <td width="11%" align="left" style="padding-left:10px;">
                    <a href="{% url search.views.results %}?q={{q}}&{% if optionsUp == '1'%}optionsUp=1&{%endif%}order={%if params.order == 'HostName'%}-HostName{%else%}HostName{%endif%}&mode={{mode}}&type={{params.type}}">
                        {%if params.order == 'HostName'%}<img src="/media/images/asc.gif"/>
                        {%else%}{%if params.order == '-HostName'%}<img src="/media/images/desc.gif"/>{%endif%}{%endif%}
                        Host
                    </a>
                </td>
            </tr>
            </thead>
            
            
            {# start spitting out results #}
            
            <tbody>
            {% for file in filesfound %}
            
                <tr class="{% cycle '' 'darkrow' %}" style="font-size:12px;line-height:18px;height:24px;">
                    <td style="padding-left:3px;;"><a href="">
                        <img src="/media/images/{% if file.path.hid.flags == 24 %}online.gif{%else%}offline.gif{%endif%}" />
                    </a>
                    </td>
                    <td>
                        {%if file.path.hid.servesDirect %}<a href="{{file|makeLink:'True'}}" title="direct download!">
                        <img src="/media/images/arrowBlueDown2.png" width="15px" id="directImg"/></a>
                        {%endif%}
                        <a href="{{file|makeLink}}"
                           title="{{file.oldname}}"
                           class="fileLink" rel="nofollow">
                            {% if mode == 'filesSubstr' or mode == 'filesdirsSubstr' %}{{file|highlight:words}}
                            {%else%}{{file|highlight:words}}{%endif%}
                        </a>
                    </td>
                    <td>
                        {% with file|size as size %}
                        {{size|sizeToReadable}}
                        {% endwith %}
                    </td>
                    <td align="center">
                        {{file.dateadded|dateToReadable}}
                    </td>
                    <td align="left" style="padding-left:10px;">
                        {% with file|host as host %}
                        <a href="smb://{{host}}">{{host.smb}}</a>
                        {% endwith %}
                    </td>
                </tr>
                {# <tr> <td></td><td>{{file.id}}</td></tr>#}
            {% endfor %}
            </tbody>
        </table>
    </div>
    
    {# result pages - this is ugly, and needs to not be tables eventually #}
    
    <div style="text-align:center;margin-top:10px;">
			{% if total > 50  and paginator > 0%}
            <div align="center" id="pagelinks">
                <table border='0' cellpadding='0' rules='none' cellspacing='0'>
                    <tr>
                        <td>
                            <a href=""><img src="/media/images/left.gif" /></a>
                        </td>
                        {% for number in paginator %}
                            <td><img src="/media/images/mid.gif" /></td>
                        {% endfor%}
                        <td>
                            <a href=""><img src="/media/images/right.gif" /></a>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <a href="{% url search.views.results %}{{prev}}/?q={{q}}&optionsUp={{optionsUp}}&mode={{mode}}&order={{params.order}}&type={{params.type}}">Prev</a>
                        </td>
                        {% for number in paginator %}
                            <td>
                                {% if number == page%}
                                    {{number}}
                                {%else%}
								<a href="{% url search.views.results %}{{number}}/?q={{q}}&optionsUp={{optionsUp}}&mode={{mode}}&order={{params.order}}&type={{params.type}}">{{number}}</a>
                                {%endif%}
                            </td>
                        {% endfor%}
                        <td align="right">
                            <a href="{% url search.views.results %}{{next}}/?q={{q}}&optionsUp={{optionsUp}}&mode={{mode}}&order={{params.order}}&type={{params.type}}">Next</a>
                        </td>
                    </tr>
                </table>
            </div>
        {% endif%}
        <br />
        Found {{ total }} match{{total|pluralize:" ,es"}}.<br>
        search took {{time}}s<br>
		{% if fileErrors > 0 %} Encountered {{fileErrors}} error{{fileErrors|pluralize}}<!--{{errorids}} -->{%endif%}
    </div>
    {% else %}
    <div style="margin:0 auto;text-align:center;">
        {% if error %}
            {{error|safe}}<br/>
            <br />
        {%else%}
        <span>Sorry, we couldn't find anything that matched. Try making a <a href="{%url requests.views.open %}">request</a>.</span>
        {%endif%}
    </div>
    {%endif%}
    <br />{% if debug %}{{filesfoundtest}}, {{words}},{{filesfinder}},<br>{{filesfound}}{%endif%}

{% endblock %}
